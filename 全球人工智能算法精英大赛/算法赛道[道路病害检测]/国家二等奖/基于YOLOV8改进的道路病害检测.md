
# 🚧 基于YOLOV8-ConvNext v2改进的道路病害目标检测

## 📊 赛题以及数据集问题分析

### 🔍 比赛数据集分析

1. **问题一：数据集样本分布不均匀**：
   
   数据集中纵向裂缝和修补裂缝占比大，而修补坑槽、修补网状裂缝、坑槽、龟裂、块状裂缝占比非常小。这容易导致那些样本的特征无论如何拟合也无法实现完整特征值的覆盖，同时也可能会产生过度依赖于有限的数据样本而导致过拟合的问题，使得模型不能得到很好的泛化提升。

   ![数据分布](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/fenbu.png)

2. **问题二：数据集标签分类模糊/错误**：

   标签存在误标的情况，例如20127-out_ori.jpg，其中图上的裂缝为纵向裂缝，但官方实际给的标签集中显示的是0即为横向裂缝，这容易导致机器在学习的过程中混淆纵向裂缝与横向裂缝这二者的分类，导致模型性能的下降。

   ![数据分布](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/cuowu.jpg)

## 💡 方案以及创新性介绍

### 🔧 Baseline——YOLOv8

YOLOv8的创新主要体现在模型架构和训练策略的巧妙设计上：

1. 通过采用SOTA模型，支持多分辨率和尺度选择，实现了对不同场景的高效适配。
2. 在骨干网络和Neck部分的调整中，借鉴了YOLOv7 ELAN的思想，采用C2f结构并微调通道数，提升了模型性能。
3. Head部分的解耦头结构和Anchor-Free的转变，表明对目标检测核心部分的深入思考。Loss计算引入TaskAlignedAssigner和Distribution Focal Loss，为更准确的定位和分类提供支持。
4. 在数据增强方面，吸纳了YOLOX的策略，并精心关闭Mosaic增强，进一步提高了模型的精度。

| ![yolov8](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/yolov8.jpg) |
|:--:|
| **参考文档：MMYOLO > YOLOv8原理和实现全解析** |

### 📈 主干修改

本方案的提出借鉴了CVPR2023发表的ConvNeXt V2。该文中作者对ConvNeXt架构进行了创新性改进，引入全卷积掩码自动编码器框架和全局响应归一化层。这一设计强化了通道间特征竞争，提升了模型性能。该研究的关键创新点在于将自监督学习技术和架构改进相结合，形成了ConvNeXt V2模型系列。这一系列模型在ImageNet分类、COCO检测和ADE20K分割等多个基准上都取得了显著的性能提升。

![原理](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/convnextv2.jpg)

于是我们队伍设计出将YOLOv8与ConvNeXtv2结合的新框架，并且在测试集上进行mAP值的比对，发现性能有显著的提升。

![骨干](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/backbone.jpg)

### 🔄 数据增强

1. **填鸭式数据扩增**:

    - 通过从误判的图像中剪裁出目标，如影子或路面纹理，将其填充到其他图像的适当位置，模拟真实场景中的多样性。这提高了模型对病害在不同环境中的适应性，增强了检测性能和鲁棒性。
    - 裁剪出单个裂缝的图像，然后将这些裂缝图像粘贴到一个背景图上，以平衡样本数量，使模型更全面地学习裂缝特征，提高在实际道路场景中的检测准确性。

    | ![背景](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/bg.jpg) | ![填鸭](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/tianya.jpg) | ![锚框](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/maokuang.jpg) |
    |:--:|:--:|:--:|

2. **TTA测试结果比对（以A榜测试结果为例）**: 经过TTA增强技术，分数上涨0.003。
3. **在线数据增强**: 上下、左右翻转、旋转90度（除横纵向裂缝）；亮度、对比度增强；使用mosaic和mixup增强技术。
4. **增大训练的batchsize和epoch**: 为了提高模型的性能，将16调整至32，同时epoch提升至300轮。
5. **在推理阶段使用TTA增强技术**
6. **在训练阶段的优化器采用consine的学习率衰减策略，初始值为0.01**
7. **加入预训练权重**: 结合yolov8s的预训练权重效果最好。
8. **使用标签平滑技术**: 将参数设置成0.1，缓解数据分布不平衡的问题的同时降低误测的概率。

## 🔬 数据结果分析以及实验的科学性

1. **YOLOv8与YOLOv8-ConvNeXtv2对比**:
   
   YOLOv8在测试集上的mAP值为0.299，加入ConvNeXtv2模块后，模型性能提升，在测试集上的mAP值为0.310，上涨0.011。YOLOv8下的测试结果只能测得一个修补裂缝，改进后的模型既能测出修补裂缝又能测出龟裂。

   ![对比1](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/duibi1.jpg)

2. **数据增强前后对比**:
   
   增强前在测试集上的mAP值为0.310，数据增强后，模型性能提升，在测试集上的mAP值为0.324，上涨0.014。没有增强前，修补裂缝测不出，并且纵向裂缝误测成横向裂缝；增强后，将修补裂缝和横向裂缝测出，同时纵向裂缝测试正确，提高了框的精度。

   ![对比2](https://weshare.xin/全球人工智能算法精英大赛/算法赛道[道路病害检测]/国家二等奖/duibi2.jpg)

## 📝 总结

1. **针对样本数据类别不平衡**:

    考虑了在线数据增强策略，对图像进行上下、左右翻转及90度旋转在龟裂块状裂缝这种裂缝上的类别不变性，以捕捉不同视角信息。同时进一步调整亮度和对比度，提高图像质量。引入mosaic和mixup技术，通过填充和旋转等处理，巧妙地融合图像，丰富特征。此外运用填鸭式数据增强，大范围增加类别少的标签。这些措施改善了不平衡问题，为模型提供更全面的数据视角，提升目标检测的精准性可靠性。

2. **针对模型泛化能力**:

    引入了GRDDC2020数据集，同时训练驾驶和无人机视角以优化裂缝在多环境下的识别。同时模型训练采用yolov8s预训练权重，构建一个YOLO模型对象的同时并加载预训练的权重文件。此外修改YOLOv8的backbone，嵌入convnextv2模块，进一步优化模型骨干结构。结合多视角训练和预训练权重，使得模型在裂缝检测上表现出色，提升了在不同环境下裂缝识别的准确性。

3. **针对模型大小分析**:

    在道路病害目标检测背景下，YOLOv8的一阶段设计更为有利。相较于二阶段模型，如Faster R-CNN，YOLOv8以全图一次推理为基础，能够迅速捕捉道路病害，其简洁的端到端结构降低了额外的复杂性，有助于更快的模型部署和运行。在道路场景中，YOLOv8通过有效的特征金字塔和锚框策略，准确捕捉不同尺度的病害，尤其在小尺寸病害和复杂路况下表现卓越，彰显了一阶段模型在实际应用中的优势。

4. **针对推理阶段的标签增强**:

    在模型训练结束推理阶段，运用TTA经过多次图像变换，拓展了模型对不同道路场景的理解。在复杂道路条件下，例如光照变化、路面不均等，TTA提供了更全面的训练数据视角。这样，模型在推理时能更好地适应真实世界的多样性。通过增加样本多样性，TTA增强了对各类病害的检测性能，使其更具鲁棒性，提升了在实际道路环境中检测各类病害的可靠性。
   
- 想进一步学习YOLO技术？访问：[YOLO Master](https://github.com/chg0901/yolo_master) 📚

- 这个仓库提供了丰富的资源和文档，帮助您全面了解和掌握YOLO技术。
